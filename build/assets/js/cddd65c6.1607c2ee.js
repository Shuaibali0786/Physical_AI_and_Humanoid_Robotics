"use strict";(globalThis.webpackChunkphysical_ai_humanoid_robotics_book=globalThis.webpackChunkphysical_ai_humanoid_robotics_book||[]).push([[62],{7172:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>a,contentTitle:()=>o,default:()=>p,frontMatter:()=>l,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"modules/ros2-nervous-system/python-integration/rclpy-basics","title":"rclpy Basics","description":"Introduction to rclpy","source":"@site/docs/modules/ros2-nervous-system/python-integration/rclpy-basics.md","sourceDirName":"modules/ros2-nervous-system/python-integration","slug":"/modules/ros2-nervous-system/python-integration/rclpy-basics","permalink":"/docs/modules/ros2-nervous-system/python-integration/rclpy-basics","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"modules","previous":{"title":"Python Agents & ROS 2 Integration","permalink":"/docs/modules/ros2-nervous-system/python-integration/"},"next":{"title":"Python Agent Communication","permalink":"/docs/modules/ros2-nervous-system/python-integration/agent-communication"}}');var i=n(4848),t=n(8453);const l={},o="rclpy Basics",a={},c=[{value:"Introduction to rclpy",id:"introduction-to-rclpy",level:2},{value:"Setting Up rclpy",id:"setting-up-rclpy",level:2},{value:"Creating a Node",id:"creating-a-node",level:2},{value:"Publishers",id:"publishers",level:2},{value:"Subscribers",id:"subscribers",level:2},{value:"Services",id:"services",level:2},{value:"Clients",id:"clients",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Best Practices",id:"best-practices",level:2}];function d(e){const r={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.header,{children:(0,i.jsx)(r.h1,{id:"rclpy-basics",children:"rclpy Basics"})}),"\n",(0,i.jsx)(r.h2,{id:"introduction-to-rclpy",children:"Introduction to rclpy"}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.code,{children:"rclpy"})," is the Python client library for ROS 2. It provides the standard interface for Python programs to interact with ROS 2, allowing Python developers to create nodes, publish and subscribe to topics, provide and use services, and more."]}),"\n",(0,i.jsx)(r.h2,{id:"setting-up-rclpy",children:"Setting Up rclpy"}),"\n",(0,i.jsx)(r.p,{children:"To use rclpy in your Python project, you need to install it as part of the ROS 2 distribution. If you have ROS 2 installed, rclpy should already be available."}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\n"})}),"\n",(0,i.jsx)(r.h2,{id:"creating-a-node",children:"Creating a Node"}),"\n",(0,i.jsx)(r.p,{children:"The basic structure of a Python ROS 2 node is:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\n\r\nclass MyNode(Node):\r\n    def __init__(self):\r\n        super().__init__('node_name')\r\n        # Node initialization code here\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = MyNode()\r\n    rclpy.spin(node)\r\n    node.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(r.h2,{id:"publishers",children:"Publishers"}),"\n",(0,i.jsx)(r.p,{children:"To create a publisher in rclpy:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"from std_msgs.msg import String\r\n\r\nclass PublisherNode(Node):\r\n    def __init__(self):\r\n        super().__init__('publisher_node')\r\n        self.publisher = self.create_publisher(String, 'topic_name', 10)\r\n        timer_period = 0.5  # seconds\r\n        self.timer = self.create_timer(timer_period, self.timer_callback)\r\n        self.i = 0\r\n\r\n    def timer_callback(self):\r\n        msg = String()\r\n        msg.data = 'Hello World: %d' % self.i\r\n        self.publisher.publish(msg)\r\n        self.get_logger().info('Publishing: \"%s\"' % msg.data)\r\n        self.i += 1\n"})}),"\n",(0,i.jsx)(r.h2,{id:"subscribers",children:"Subscribers"}),"\n",(0,i.jsx)(r.p,{children:"To create a subscriber in rclpy:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"from std_msgs.msg import String\r\n\r\nclass SubscriberNode(Node):\r\n    def __init__(self):\r\n        super().__init__('subscriber_node')\r\n        self.subscription = self.create_subscription(\r\n            String,\r\n            'topic_name',\r\n            self.listener_callback,\r\n            10)\r\n        self.subscription  # prevent unused variable warning\r\n\r\n    def listener_callback(self, msg):\r\n        self.get_logger().info('I heard: \"%s\"' % msg.data)\n"})}),"\n",(0,i.jsx)(r.h2,{id:"services",children:"Services"}),"\n",(0,i.jsx)(r.p,{children:"To create a service server:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"from example_interfaces.srv import AddTwoInts\r\n\r\nclass ServiceServer(Node):\r\n    def __init__(self):\r\n        super().__init__('service_server')\r\n        self.srv = self.create_service(AddTwoInts, 'add_two_ints', self.add_two_ints_callback)\r\n\r\n    def add_two_ints_callback(self, request, response):\r\n        response.sum = request.a + request.b\r\n        self.get_logger().info('Incoming request\\na: %d b: %d' % (request.a, request.b))\r\n        return response\n"})}),"\n",(0,i.jsx)(r.h2,{id:"clients",children:"Clients"}),"\n",(0,i.jsx)(r.p,{children:"To create a service client:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"from example_interfaces.srv import AddTwoInts\r\n\r\nclass ServiceClient(Node):\r\n    def __init__(self):\r\n        super().__init__('service_client')\r\n        self.cli = self.create_client(AddTwoInts, 'add_two_ints')\r\n        while not self.cli.wait_for_service(timeout_sec=1.0):\r\n            self.get_logger().info('service not available, waiting again...')\r\n        self.req = AddTwoInts.Request()\r\n\r\n    def send_request(self, a, b):\r\n        self.req.a = a\r\n        self.req.b = b\r\n        self.future = self.cli.call_async(self.req)\r\n        rclpy.spin_until_future_complete(self, self.future)\r\n        return self.future.result()\n"})}),"\n",(0,i.jsx)(r.h2,{id:"parameters",children:"Parameters"}),"\n",(0,i.jsx)(r.p,{children:"Nodes can also handle parameters:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"class ParameterNode(Node):\r\n    def __init__(self):\r\n        super().__init__('parameter_node')\r\n        self.declare_parameter('my_parameter', 'default_value')\r\n\r\n    def get_parameter_value(self):\r\n        param = self.get_parameter('my_parameter')\r\n        return param.value\n"})}),"\n",(0,i.jsx)(r.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsxs)(r.ol,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Always call rclpy.init()"})," before creating nodes"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Use proper node naming"})," to avoid conflicts"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Handle exceptions"})," in callbacks appropriately"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Use appropriate queue sizes"})," for publishers and subscribers"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Clean up resources"})," by destroying nodes properly"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Use logging"})," to help with debugging"]}),"\n"]})]})}function p(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>l,x:()=>o});var s=n(6540);const i={},t=s.createContext(i);function l(e){const r=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(t.Provider,{value:r},e.children)}}}]);