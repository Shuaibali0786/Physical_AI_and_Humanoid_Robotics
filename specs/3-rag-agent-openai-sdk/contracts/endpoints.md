# API Contracts: RAG Agent with OpenAI Agent SDK + FastAPI

## Query Endpoint
**Purpose**: Accept user queries and return contextually accurate answers based on retrieved content
**Method**: POST
**Path**: `/query`
**Request Body**:
- query: string (required, the user's question or query text)
- max_results: integer (optional, number of results to retrieve from Qdrant, default 5)
- temperature: float (optional, creativity parameter for the agent, default 0.7)
- metadata_filters: object (optional, filters to apply when retrieving content from Qdrant)

**Response Body**:
- answer: string (the final answer generated by the agent)
- query: string (the original query that was answered)
- retrieved_chunks: array of objects (list of chunks used to generate the response)
  - id: string (unique identifier for the chunk)
  - content: string (the actual content text)
  - score: float (similarity score from Qdrant search)
  - url: string (source URL of the content)
  - title: string (title of the content source)
- sources: array<string> (list of source URLs referenced in the response)
- confidence: float (confidence score of the response)
- timestamp: string (ISO format timestamp of when the response was generated)

**Status Codes**:
- 200: Successful response with answer
- 400: Invalid request parameters
- 422: Unprocessable request (malformed query)
- 500: Internal server error (Qdrant connection, OpenAI API issues)

## Health Check Endpoint
**Purpose**: Check the health status of the RAG agent service
**Method**: GET
**Path**: `/health`
**Request Body**: None
**Response Body**:
- status: string (overall health status: "healthy", "degraded", "unhealthy")
- details: object (detailed status of individual components)
  - qdrant_connection: string (status of Qdrant connection)
  - openai_agent: string (status of OpenAI agent availability)
  - timestamp: string (ISO format timestamp of check)

**Status Codes**:
- 200: Service is healthy
- 503: Service is unhealthy or degraded

## Configuration Endpoint
**Purpose**: Get the current configuration of the RAG agent
**Method**: GET
**Path**: `/config`
**Request Body**: None
**Response Body**:
- qdrant_collection: string (name of the Qdrant collection being used)
- max_results_default: integer (default number of results retrieved)
- temperature_default: float (default temperature setting)
- available_models: array<string> (list of available OpenAI models)

**Status Codes**:
- 200: Configuration retrieved successfully
- 500: Error retrieving configuration